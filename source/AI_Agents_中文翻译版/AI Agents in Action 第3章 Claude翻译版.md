# AI Agents in Action 第3章 Claude翻译版

================================================================================
第3章 使用 GPT 助手
================================================================================
**原书名称:** AI Agents in Action.pdf
**页码范围:** 63 - 91
**翻译说明:** 本翻译由 Claude AI 协助完成，仅供个人学习使用
================================================================================

## 第3章 使用 GPT 助手

当我们探索 OpenAI 进军助手领域的努力以及已经暗示的最终智能体平台（称为 GPT Assistants）时，我们将通过 ChatGPT 界面介绍 GPT 助手。然后，我们将添加几个完全开发的助手，它们可以根据食材建议食谱、作为数据科学家完全分析数据、引导读者阅读书籍，并通过自定义动作进行扩展。到本章结束时，我们将准备好构建一个可以发布到 OpenAI GPT Store 的完全功能的智能体。

### 本章内容概要
- 介绍 OpenAI GPT Assistants 平台和 ChatGPT UI
- 构建可以使用代码解释功能的 GPT
- 通过自定义动作扩展助手
- 通过文件上传向 GPT 添加知识
- 将你的 GPT 商业化并发布到 GPT Store

## 3.1 通过 ChatGPT 探索 GPT 助手

ChatGPT（在撰写本文时为 ChatGPT Plus）允许你构建 GPT 助手、使用其他助手，甚至发布它们，正如你将在本章结束时看到的那样。当 OpenAI 宣布发布 GPT Assistants 平台时，它帮助定义并巩固了 AI 智能体的出现。因此，对于任何有兴趣构建和使用智能体系统的人来说，这值得认真审查。首先，我们将了解通过 ChatGPT Plus 构建 GPT 助手，这需要高级订阅。如果你不想购买订阅，可以浏览本章作为入门，第 6 章将演示稍后使用 API 服务。

图 3.1 显示了 ChatGPT 中 GPT Store 的页面（https://chatgpt.com/gpts）。从这里，你可以搜索和探索几乎任何任务的各种 GPT。使用量通常会指示每个 GPT 的效果如何，因此可以衡量哪个最适合你。

**GPT Store 主界面功能：**
- 探索你制作的 GPT
- 按名称或类别搜索 GPT
- 单击"创建"以创建你自己的 GPT

创建你的第一个 GPT 助手就像单击"创建"按钮并跟随 GPT Builder 聊天界面一样简单。图 3.2 显示了使用 Builder 创建 GPT。多次完成此练习可以是开始了解助手要求的好方法。

**GPT Builder 界面功能：**
- Builder 可以引导你完成创建过程
- 与 Builder 对话以创建你的 GPT

在使用 Builder 之后，你可以打开手动配置面板（如图 3.3 所示）并直接编辑 GPT。你将看到从与 Builder 的对话中填充的名称、描述、指令和对话启动器。这可能是一个很好的开始，但通常你会想要手动编辑和调整这些属性。

**Configure（配置）面板功能：**
- 使用 Builder 将为你的助手生成一组指令，或者你可以完全从头开始
- Configure 面板让你直接控制 GPT 的属性
- 好的名称和描述对于发布此智能体至关重要
- 好的对话启动器可以帮助用户快速了解你的智能体做什么以及如何工作

如果你想跟着构建自己的 Culinary Companion，请将清单 3.1 中的文本输入到指令中。这些指令部分是通过与 Builder 对话生成的，并基于明确的输出添加的。明确的输出作为规则添加到指令中。

**代码清单 3.1: Culinary Companion 的指令**

```
Culinary Companion assists users with a friendly, engaging tone,
reminiscent of the famous chef Julia Child.

It provides quick meal ideas and simplifies complex recipes, focusing on
ingredients the user already has. This GPT emphasizes practical, easy-
to-follow culinary advice and adapts to dietary preferences. It's
designed to make cooking a more accessible and enjoyable experience,
encouraging users to experiment with their meals while offering helpful
tips in a warm, approachable manner.

RULES:
When generating a recipe, always create an image of the final prepared
recipe.

When generating a recipe, estimate the calories and nutritional values
per serving.

When generating a recipe, provide a shopping list of ingredients with
estimated prices needed to complete the recipe.

When generating a recipe, estimate the total cost per serving based on
the shopping list.
```

**说明：**
- 助手的个性或角色
- 智能体角色和目标的一般指南
- 智能体在建议食谱时将遵循的一组规则

为助手/智能体定义规则本质上是为智能体将产生的内容创建模板。添加规则确保 GPT 输出一致并符合你对智能体应如何操作的期望。为智能体/助手定义并赋予角色可为它们提供独特且令人难忘的个性。

**注意：** 赋予智能体/助手特定个性可以在输出的类型和形式上产生差异。要求烹饪智能体像第一位名人厨师 Julia Child 一样说话，不仅提供了有趣的语气，还引用了更多可能提及或谈论她的烹饪风格和教学的参考。在构建智能体/助手时，分配特定的角色/个性可能会有所帮助。

只需这几个步骤，我们就有了一个烹饪伴侣，它不仅为我们手头的食材提供食谱，还生成成品食谱的图像、估算营养价值、创建带价格估算的购物清单，并分解每份成本。

通过请求食谱并提供你拥有或喜欢的食材列表来尝试助手。清单 3.2 显示了一个简单请求的示例，其中包含用于设置氛围的额外信息。当然，你可以添加任何你喜欢的食材或情况，然后查看结果。

**代码清单 3.2: 提示食谱**

```
I have a bag of prepared frozen chicken strips and I want to make a
romantic dinner for two.
```

图 3.4 显示了 GPT 根据提示提供的格式化输出结果。看起来确实很诱人。所有这些输出都是因为我们提供给智能体的指令而生成的。

**GPT 助手创建食谱输出示例：**

```
Chicken Parmesan with Spaghetti Recipe

Ingredients:
1 bag of frozen prepared chicken strips
1 jar of your favorite marinara sauce
1 cup of shredded mozzarella cheese
1/4 cup of grated Parmesan cheese
200g of spaghetti
1 tablespoon of olive oil
2 cloves of garlic, minced
Fresh basil leaves (for garnish)
Salt and pepper to taste

Estimated Costs:
Chicken strips: $6.00
Marinara sauce: $3.00
Mozzarella cheese: $2.00
Parmesan cheese: $1.50
Spaghetti: $1.00
Garlic: $0.30
Basil: $0.50
Total estimated cost: $14.30
Cost per serving: approximately $7.15

Nutritional Values per Serving:
Calories: 600 kcal
Protein: 35 g
Carbohydrates: 75 g
Fat: 18 g

Instructions: (not shown)

Generated by the Culinary Companion GPT Assistant
```

**图 3.4: Culinary Companion GPT 的输出结果**
- GPT 助手根据提供的食材创建食谱
- 提供带成本和每份成本的购物清单
- 提供每份营养信息
- 提供如何烹饪食谱的说明

虽然输出结果看起来很棒，但它们可能并非全部真实和正确，你的结果可能会有所不同。例如，GPT 将鸡柳添加到购物清单中，而我们已经建议拥有这些食材。此外，价格和估计的营养信息只是估计值，但如果你感兴趣，可以稍后解决这个问题。

不过，开箱即用，GPT Assistants 对于快速构建概念验证助手或智能体来说相当令人印象深刻。正如你将在本章后面看到的那样，它还为在 ChatGPT 之外使用助手提供了一个出色的平台。在下一节中，我们将了解 GPT 提供的更令人印象深刻的功能，例如文件上传和代码解释。

## 3.2 构建可以做数据科学的 GPT

GPT Assistants 平台有并且可能会扩展以包含各种智能体组件。目前，GPT Assistants 支持所谓的知识、内存和动作。在第 8 章中，我们将讨论知识和内存的细节，在第 5 章中，我们将介绍通过动作使用工具的概念。

在我们的下一个练习中，我们将构建一个助手来对我们提供的任何 CSV 文档执行首次数据科学审查。此智能体将使用允许编码和代码解释的能力或动作。当你启用代码解释时，助手将默认允许文件上传。

不过，在这样做之前，我们想要设计我们的智能体，还有什么比要求 LLM 为我们构建助手更好的方法呢？清单 3.3 显示了请求 ChatGPT（GPT-4）设计数据科学助手的提示。请注意我们如何不在单个提示中要求所有内容，而是迭代 LLM 返回的信息。

**代码清单 3.3: 提示数据科学助手**

```
FIRST PROMPT:
what is a good basic and interesting data science
experiment you can task someone with a single
csv file that contains interesting data?

SECOND PROMPT:
okay, can you now write all those steps into instructions
to be used for a GPT Agent (LLM agent) to replicate all of
the above steps

THIRD PROMPT:
What is a famous personality that can embody the agent
data scientist and be able to present data to users?
```

**说明：**
- 首先，要求 LLM 设定基础
- 然后，要求 LLM 将之前的步骤转换为更正式的过程
- 最后，要求 LLM 提供可以代表该过程的个性

该对话的结果提供了清单 3.4 中显示的助手指令。在这种情况下，助手被命名为 Data Scout，但你可以随意命名你的助手。

**代码清单 3.4: Data Scout 指令**

```
This GPT, named Data Scout, is designed to assist users by analyzing CSV
files and providing insights like Nate Silver, a famous statistician known
for his accessible and engaging approach to data. Data Scout combines
rigorous analysis with a clear and approachable communication style,
making complex data insights understandable. It is equipped to handle
statistical testing, predictive modeling, data visualization, and more,
offering suggestions for further exploration based on solid data-driven
evidence.

Data Scout requires the user to upload a csv file of data they want to
analyze. After the user uploads the file you will perform the following
tasks:

1. Data Acquisition
    Ask the user to upload a csv file of data.
    Instructions: Use the pandas library to read the data from the CSV
file. Ensure the data is correctly loaded by displaying the first few rows
using df.head().

2. Exploratory Data Analysis (EDA)

Data Cleaning
    Task: Identify and handle missing values, correct data types.
    Instructions: Check for missing values using df.isnull().sum(). For
categorical data, consider filling missing values with the mode, and for
numerical data, use the median or mean. Convert data types if necessary
using df.astype().

Visualization
    Task: Create visualizations to explore the data.
    Instructions: Use matplotlib and seaborn to create histograms, scatter
plots, and box plots. For example, use sns.histplot() for histograms and
sns.scatterplot() for scatter plots.

Descriptive Statistics
    Task: Calculate basic statistical measures.
    Instructions: Use df.describe() to get a summary of the statistics and
df.mean(), df.median() for specific calculations.

3. Hypothesis Testing
    Task: Test a hypothesis formulated based on the dataset.
    Instructions: Depending on the data type, perform statistical tests
like the t-test or chi-squared test using scipy.stats. For example, use
stats.ttest_ind() for the t-test between two groups.

4. Predictive Modeling

Feature Engineering
    Task: Enhance the dataset with new features.
    Instructions: Create new columns in the DataFrame based on existing
data to capture additional information or relationships. Use operations
like df['new_feature'] = df['feature1'] / df['feature2'].

Model Selection
    Task: Choose and configure a machine learning model.
    Instructions: Based on the task (classification or regression), select
a model from scikit-learn, like RandomForestClassifier() or
LinearRegression(). Configure the model parameters.

Training and Testing
    Task: Split the data into training and testing sets, then train the
model.
    Instructions: Use train_test_split from scikit-learn to divide the
data. Train the model using model.fit(X_train, y_train).

Model Evaluation
    Task: Assess the model performance.
    Instructions: Use metrics like mean squared error (MSE) or accuracy.
Calculate these using metrics.mean_squared_error(y_test, y_pred) or
metrics.accuracy_score(y_test, y_pred).

5. Insights and Conclusions
    Task: Interpret and summarize the findings from the analysis and
modeling.
    Instructions: Discuss the model coefficients or feature importances.
Draw conclusions about the hypothesis and the predictive analysis. Suggest
real-world implications or actions based on the results.

6. Presentation
    Task: Prepare a report or presentation.
    Instructions: Summarize the process and findings in a clear and
accessible format, using plots and bullet points. Ensure that the
presentation is understandable for non-technical stakeholders.
```

生成指令后，你可以将它们复制并粘贴到图 3.5 中的 Configure 面板中。确保通过选择相应的复选框为助手提供代码解释工具（技能）。你不需要在这里上传文件；当启用代码解释复选框时，助手将允许文件上传。

**图 3.5: 打开代码解释工具/技能**
- 对话启动器提供快速描述并引导用户
- 确保选择代码解释器

现在，我们可以通过上传 CSV 文件并询问有关它的问题来测试助手。本章的源代码文件夹包含一个名为 `netflix_titles.csv` 的文件；前几行在清单 3.5 中总结。当然，你可以使用任何你想要的 CSV 文件，但本练习将使用 Netflix 示例。请注意，此数据集是从 Kaggle 下载的，但如果你愿意，可以使用任何其他 CSV。

**代码清单 3.5: netflix_titles.csv（数据的顶行）**

```
show_id,type,title,director,cast,country,date_added,
release_year,rating,duration,listed_in,description

s1,Movie,Dick Johnson Is Dead,Kirsten Johnson,,
United States,"September 25, 2021",2020,PG-13,90 min,
Documentaries,"As her father nears the end of his life,
filmmaker Kirsten Johnson stages his death in inventive
and comical ways to help them both face the inevitable."
```

**说明：**
- 逗号分隔的列列表
- 数据集中的示例数据行

我们可以上传文件并要求助手完成其工作，但对于本练习，我们将更具体。清单 3.6 显示了提示并上传文件以使用助手（在请求中包括 `Netflix_titles.csv`）。此示例将结果过滤到加拿大，但你当然可以使用你想查看的任何国家。

**代码清单 3.6: 提示 Data Scout**

```
Analyze the attached CSV and filter the results to the
country Canada and output any significant discoveries
in trends etc.
```

**说明：** 你可以选择不同的国家来过滤数据

如果你在助手解析文件时遇到问题，请刷新浏览器窗口并重试。根据你的数据和过滤器，助手现在将像数据科学家一样使用代码解释器来分析和提取数据中的趋势。

图 3.6 显示了使用清单 3.5 中的提示和 `netflix_titles.csv` 文件生成的输出。如果你选择不同的国家或请求其他分析，你的输出可能看起来非常不同。

**图 3.6: 助手分析 CSV 数据时生成的输出**
- 加拿大内容中的前 10 大流行类型
- 评级分布
- 内容类型分布
- 多年来发布的趋势

助手正在构建的数据科学图是通过使用代码解释器编写和执行代码创建的。你可以使用其他 CSV 文件尝试此操作，或者如果你愿意，可以使用不同形式的数据进行分析。你甚至可以继续与助手迭代以在视觉上更新图或分析其他趋势。

代码解释是一项引人注目的技能，你可能会将其添加到许多智能体中，用于从计算到自定义格式的所有内容。在下一节中，我们将了解如何通过自定义动作扩展 GPT 的功能。

## 3.3 自定义 GPT 并添加自定义动作

在我们的下一个练习中，我们将演示自定义动作的使用，这可以显著扩展你的助手的范围。向智能体添加自定义动作需要几个组件，从理解 OpenAPI 规范端点到连接到服务。因此，在我们添加自定义动作之前，我们将在下一节中构建另一个 GPT 来协助我们。

### 3.3.1 创建助手来构建助手

鉴于 GPT 的能力，我们使用一个来协助构建其他助手是有道理的。在本节中，我们将构建一个 GPT，它可以帮助我们创建一个服务，我们可以将其作为自定义动作连接到另一个 GPT。是的，我们甚至会使用 LLM 来开始构建我们的辅助 GPT。

以下清单显示了用于创建我们的辅助 GPT 指令的提示。此提示旨在生成助手的指令。

**代码清单 3.7: 提示辅助设计（在 GPT Builder 或 ChatGPT 中）**

```
I want to create a GPT assistant that can generate a FastAPI service that
will perform some action to be specified. As part of the FastAPI code
generation, I want the assistant to generate the OpenAPI specification for
the endpoint. Please outline a set of instructions for this agent.
```

清单 3.8 显示了为提示生成的大部分指令。然后，输出被修改并略微更新了特定信息和其他细节。从文件（`assistant_builder.txt`）中复制并粘贴这些指令到你的 GPT 中。确保也选择代码解释器功能。

**代码清单 3.8: 自定义动作助手指令**

```
This GPT is designed to assist users in generating FastAPI services
tailored to specific actions, complete with the corresponding OpenAPI
specifications for the endpoints. The assistant will provide code snippets
and guidance on structuring and documenting API services using FastAPI,
ensuring that the generated services are ready for integration and
deployment.

1. Define the Action and Endpoint: First, determine the specific action
the FastAPI service should perform. This could be anything from fetching
data, processing information, or interacting with other APIs or databases.

2. Design the API Endpoint: Decide on the HTTP method (GET, POST, PUT,
DELETE, etc.) and the endpoint URI structure. Define the input parameters
(path, query, or body parameters) and the expected response structure.

3. Generate FastAPI Code:
    Setup FastAPI: Import FastAPI and other necessary libraries.
    Create API Function: Write a Python function that performs the
desired action. This function should accept the defined input parameters
and return the appropriate response.

4. Decorate the Function: Use FastAPI's decorators (e.g.,
@app.get("/endpoint")) to link the function with the specified endpoint
and HTTP method.
    Define Input and Output Models: Use Pydantic models to define the
structure of the input and output data. This ensures validation and
serialization of the data.

5. Generate OpenAPI Specification:
    FastAPI automatically generates the OpenAPI specification based on
the endpoint definitions and Pydantic models. Ensure that all function
parameters and models are well-documented using docstrings and field
descriptions.
    Optionally, customize the OpenAPI specification by adding
metadata, tags, or additional responses directly in the FastAPI decorators.

6. Deployment:
    Describe to the user how to prepare the FastAPI application for
deployment.
    Instruct them on how to use ngrok to deploy the
service and host it on the user's local machine.
```

**说明：** 这使用 ngrok 作为在本地部署服务的示例

准备好助手后，确保在 Configure 面板中设置了所有内容（包括设置代码解释器复选框），然后刷新浏览器窗口。这将为新会话准备助手。你可以从这里请求你想要构建的服务类型。

清单 3.9 显示了向自定义动作助手请求创建每日任务端点的请求。如果你了解 API 的工作原理，可以建议其他选项，例如 POST。当然，你也可以要求助手指导你并创建你的服务。

**代码清单 3.9: 提示请求任务端点服务**

```
I want to define a GET endpoint that replies with my list of daily tasks
```

输入提示后，助手将生成用于创建和运行 FastAPI 端点的代码和说明。以下清单显示了从之前请求生成的代码示例。

**代码清单 3.10: daily_tasks_api.py（从助手生成）**

```python
from fastapi import FastAPI
from pydantic import BaseModel
from typing import List

app = FastAPI()

class Task(BaseModel):  # 使用 Pydantic 创建任务类型
    id: int
    description: str
    completed: bool

tasks = [  # 这是一个静态任务列表用于演示
    Task(id=1, description="Buy groceries", completed=False),
    Task(id=2, description="Read a book", completed=True),
    Task(id=3, description="Complete FastAPI project", completed=False),
]

@app.get("/tasks", response_model=List[Task])
async def get_tasks():
    """
    Retrieve a list of daily tasks.
    """
    return tasks
```

将代码输入 Visual Studio Code（VS Code），并使用 pip 确认已安装 `fastapi` 和 `uvicorn`。然后，使用以下清单中显示的命令运行 API，该命令运行章节源文件中的 API。

**代码清单 3.11: 运行 API**

```bash
uvicorn daily_tasks_api:app --reload
```

**说明：**
- tasks 端点
- 如果你使用不同的名称，请更改模块/文件的名称

打开浏览器访问 `http://127.0.0.1:8000/docs`，这是 Swagger 端点的默认位置，如图 3.7 所示。

**图 3.7: 导航 Swagger 文档并获取 openapi.json 文档**
- 导航你的浏览器到 http://127.0.0.1:8000/docs
- 单击此链接以打开并查看 JSON 格式的 OpenAPI 规范

单击 `/openapi.json` 链接将显示端点的 OpenAPI 规范，如清单 3.12 所示（JSON 转换为 YAML）。稍后在助手上设置自定义动作时，你需要复制并保存此文档以供使用。端点生成 JSON，但你也可以使用 YAML 编写的规范。

**代码清单 3.12: 任务 API 的 OpenAPI 规范**

```yaml
openapi: 3.1.0
info:
  title: FastAPI
  version: 0.1.0
paths:
  /tasks:
    get:
      summary: Get Tasks
      description: Retrieve a list of daily tasks.
      operationId: get_tasks_tasks_get
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Task'
                title: Response Get Tasks Tasks Get
components:
  schemas:
    Task:
      type: object
      properties:
        id:
          type: integer
          title: Id
        description:
          type: string
          title: Description
        completed:
          type: boolean
          title: Completed
      required:
        - id
        - description
        - completed
      title: Task
```

在将助手连接到服务之前，你必须设置并使用 ngrok 打开到运行服务的本地机器的隧道。提示 GPT 提供说明并帮助你设置 ngrok，并运行应用程序以在你的机器上打开端口 8000 的端点，如清单 3.13 所示。如果你更改端口或使用不同的配置，则必须相应地更新它。

**代码清单 3.13: 运行 ngrok（遵循说明设置）**

```bash
./ngrok authtoken <YOUR_AUTHTOKEN>  # 输入从 ngrok.com 获得的身份验证令牌
./ngrok http 8000  # 在端口 8000 上打开到外部互联网流量的隧道
```

运行 ngrok 后，你将看到一个外部 URL，现在可以使用该 URL 访问你机器上的服务。复制此 URL 以供稍后设置助手时使用。在下一节中，我们将创建使用此服务作为自定义动作的助手。

### 3.3.2 将自定义动作连接到助手

通过在你的机器上运行服务并通过 ngrok 隧道从外部访问，我们可以构建新的助手。这次，我们将创建一个简单的助手来帮助我们组织日常任务，其中任务可以从我们本地运行的任务服务访问。

打开 GPT 界面和 Configure 面板，并将清单 3.14 中显示的指令复制并粘贴到新助手中。确保命名助手并输入有用的描述。此外，打开代码解释器功能以允许助手创建显示任务的最终图。

**代码清单 3.14: Task Organizer（task_organizer_assistant.txt）**

```
Task Organizer is designed to help the user prioritize their daily tasks
based on urgency and time availability, providing structured guidance on
how to categorize tasks by urgency and suggesting optimal time blocks for
completing these tasks. It adopts a persona inspired by Tim Ferriss, known
for his focus on productivity and efficiency. It uses clear, direct
language and avoids making assumptions about the user's free time.

When you are done organizing the tasks create a plot
showing when and how the tasks will be completed.
```

**说明：** 此功能需要启用代码解释器

单击面板底部的"创建新动作"按钮。图 3.8 显示了添加自定义动作的界面。你必须将服务的 OpenAPI 规范复制并粘贴到窗口中。然后，你必须添加一个名为 servers 的新部分，并用你的 URL 填充它，如图所示。

**图 3.8: 添加新的自定义动作**
- 将 servers 部分添加到 YAML，并输入你的服务的 ngrok URL
- 将 YAML 或 JSON 规范复制并粘贴到窗口中

设置规范后，你可以通过单击"测试"按钮对其进行测试。这将运行测试，你将在对话窗口中看到结果，如图 3.9 所示。

**图 3.9: 测试 API 服务端点配置为自定义动作**
- 返回的任务列表
- 测试端点

在你满意一切都已设置后。刷新浏览器窗口以重置会话，并输入类似清单 3.15 中显示的提示。这将提示智能体调用服务以获取你的日常任务、总结输出并解决你的任务组织难题。

**代码清单 3.15: Task Organizer 提示**

```
how should I organize my tasks for today?
```

助手应在最后生成任务计划的图。如果它弄错了或格式不是你喜欢的，你可以添加指令来指定助手应输出的格式/样式。

你可以改进服务，但如果你对 API 进行任何更改，则需要更新助手自定义动作中的规范。不过，从这里开始，你可以添加从计算机运行或作为服务托管的自定义动作服务。

**注意：** 请注意，如果你发布助手供公众使用，未知用户可以激活自定义动作，因此不要公开向你收取服务费或访问私人信息的服务，除非这是你的意图。同样，通过 ngrok 隧道打开的服务将通过助手公开，这可能值得关注。发布使用自定义动作的智能体时请小心。

自定义动作是向助手添加动态功能的好方法，无论是用于个人还是商业用途。文件上传是为助手提供静态知识的更好选择。下一节将探索使用文件上传来扩展助手的知识。

## 3.4 使用文件上传扩展助手的知识

如果你与 LLM 互动过，你可能听说过检索增强生成（RAG）模式。第 8 章将详细探讨 RAG 在知识和内存应用中的使用。使用文件上传功能不需要详细了解 RAG，但如果你需要一些基础知识，请查看该章节。

GPT Assistants 平台提供了一个称为文件上传的知识功能，它允许你以各种格式向 GPT 填充关于任何内容的静态知识库。在撰写本文时，GPT Assistants 平台允许你上传最多 512 MB 的文档。在接下来的两个练习中，我们将研究两个不同的 GPT，它们旨在帮助用户使用书籍。

### 3.4.1 构建 Calculus Made Easy GPT

书籍和书面知识将永远是我们知识库的支柱。但阅读文本是许多人没有时间进行的全职专注工作。有声读物使消费书籍再次变得容易；你可以在多任务处理时收听，但并非所有书籍都能很好地过渡到音频。

进入 AI 和智能助手的世界。使用 GPT，我们可以在读者和书籍之间创建互动体验。读者不再被迫逐页消费书籍，而是作为一个整体。

为了演示这个概念，我们将基于一本经典数学教科书构建一个 GPT，该教科书名为《Calculus Made Easy》，作者是 Silvanus P. Thompson。这本书可以通过 Gutenberg Press 网站免费获得。虽然它已有一百多年的历史，但它仍然提供了坚实的材料背景。

**注意：** 如果你认真学习微积分，但这个助手仍然太高级，请查看 Clifford A. Pickover 的一本很棒的书，名为《Calculus and Pizza》。这是一本学习微积分或只是获得出色复习的好书。如果你有电子书版本，你也可以尝试制作你的 Calculus and Pizza 助手。不幸的是，版权法会阻止你在未经许可的情况下发布此 GPT。

打开 ChatGPT，转到"My GPTs"，创建一个新的 GPT，单击"Configure"选项卡，然后上传文件，如图 3.10 所示。从章节的源代码文件夹上传书籍：`chapter_03/calculus_made_easy.pdf`。这将把书籍添加到 GPT 的知识中。

**图 3.10: 向助手的知识添加文件**
- 添加文件被视为为你的助手提供额外的知识
- 使用"上传文件"按钮添加各种静态知识源供助手使用
- 确保启用代码解释器，以便助手可以演示概念

向上滚动并添加清单 3.16 中显示的指令。初始序言文本是通过与 GPT Builder 对话生成的。更新序言文本后，通过询问 ChatGPT 有关著名数学家的信息添加了个性。然后，最后，添加了规则以为 GPT 提供关于我们想要的显式结果的额外指导。

**代码清单 3.16: Calculus Made Easy GPT 的指令**

```
This GPT is designed to be an expert teacher and mentor
of calculus based on the book 'Calculus Made Easy' by
Silvanus Thompson. A copy of the book is uploaded at
calculus_made_easy.pdf and provides detailed guidance
and explanations on various calculus topics such as
derivatives, integrals, limits, and more. The GPT can
teach calculus concepts, solve problems, and answer
questions related to calculus, making complex topics
accessible and understandable. It can handle
calculus-related inquiries, from basic to advanced,
and is particularly useful for students and educators
seeking to deepen their understanding of calculus.

Answer as the famous mathematician Terence Tao.
Terence Tao is renowned for his brilliant intellect,
approachability, and exceptional ability to effectively
simplify and communicate complex mathematical concepts.

RULES
1) Always teach the concepts as if you were teaching to a young child.
2) Always demonstrate concepts by showing plots of functions and graphs.
3) Always ask if the user wants to try a sample problem on their own.
Give them a problem equivalent to the question concept you were discussing.
```

**说明：**
- 序言最初由 Builder 生成，然后根据需要进行调整
- 务必始终为你的助手和智能体提供适当的角色/个性
- 定义明确的条件和规则可以帮助更好地引导 GPT 实现你的愿望

更新助手后，你可以在预览窗口中或通过在 GPT Store 中搜索 Calculus Made Easy 来尝试图书版本。图 3.11 显示了与 GPT 交互的剪切示例。该图显示 GPT 可以生成图来演示概念或提出问题。

**图 3.11: 从要求 GPT 教授微积分的输出**
- 对话通过要求 GPT 教授微积分基础知识开始
- GPT 还可以生成图来演示概念，例如显示函数及其导数
- 函数及其导数

此 GPT 演示了助手使用书籍作为配套教学参考的能力。在本练习中仅上传了一本书，但可以上传多本书或其他文档。随着此功能和技术的成熟，将来可能可以使用 GPT 教授整个课程。

我们将远离技术，拥抱小说，以演示知识的使用。在下一节中，我们将了解如何使用文件上传的知识进行搜索和参考。

### 3.4.2 使用文件上传进行知识搜索等

GPT Assistants 平台的文件上传功能支持单个助手最多 512 MB 的上传。仅此功能就为个人和中小型企业/项目规模的文档搜索和其他应用提供了强大的功能。

想象上传整个文件集合。你现在可以使用一个助手进行搜索、比较、对比、组织和整理。仅此功能在 GPT Assistants 中就将颠覆我们搜索和分析文档的方式。在第 6 章中，我们将研究直接访问 OpenAI Assistants API 如何增加文档数量。

对于下一个练习，我们将使用具有多本书或文档知识的助手。此技术可以应用于任何受支持的文档，但此助手将使用有关机器人的经典文本。我们将此助手命名为 Classic Robot Reads GPT。

首先在 ChatGPT 界面中创建一个新的 GPT 助手。然后，上传清单 3.17 中的指令，并命名和描述助手。这些指令部分通过 GPT Builder 生成，然后进行编辑。

**代码清单 3.17: Classic Robot Reads 指令**

```
This GPT, Classic Robot Reads and uses the persona of
Isaac Asimov and will reply as the famous robot author.

This GPT will only references and discusses the books
in its knowledge base of uploaded files.

It does not mention or discuss other books or text that
are not within its knowledge base.

RULES
Refer to only text within your knowledge base
Always provide 3 examples of any query the use asks for
Always ask the user if they require anything further
```

**说明：**
- 始终记住为你的 GPT 提供角色/个性
- 确保助手仅引用文件上传中的知识
- 添加一些额外的样式选择规则
- 通过也给他们细微差别和风格使助手更有帮助

完成这些步骤后，你可以从章节源上传名为 `gutenberg_robot_books` 的文件。图 3.12 演示了一次上传多个文件。你一次可以上传的最大文件数将根据文件的大小而变化。

**图 3.12: 将文档上传到助手的知识**
- 你可以一次上传多个文件（大约 5 个）
- 上传通过知识模式变得可供智能体访问

上传文档、设置指令并为助手提供名称和图像后，你就可以开始使用它了。搜索是知识助手的最基本应用，表 3.1 中显示了提示形式的其他用例。

**表 3.1: 知识助手的用例**

| 用例 | 示例提示 | 结果 |
|------|----------|------|
| 搜索 | Search for this phrase in your knowledge: "the robot servant." | 返回文档和摘录 |
| 比较 | Identify the three most similar books that share the same writing style. | 返回三个最相似的文档 |
| 对比 | Identify the three most different books. | 返回集合中最不同的书籍 |
| 排序 | What order should I read the books? | 返回书籍的有序进度 |
| 分类 | Which of these books is the most modern? | 对文档进行分类 |
| 生成 | Generate a fictional paragraph that mimics your knowledge of the robot servant. | 基于其知识库生成新内容 |

这些用例只是 AI 知识助手可能实现的许多功能的示例。虽然此功能可能无法颠覆企业搜索，但它为较小的组织和个人提供了更多访问其文档的权限。它允许创建助手作为可以公开公开的知识形式。在下一节中，我们将了解如何使所有人都可以使用助手。

## 3.5 发布你的 GPT

一旦你对你的 GPT 感到满意，你就可以使用它或通过提供链接与他人分享。通过 ChatGPT 使用 GPT 助手目前需要 Plus 订阅。要为他人发布你的 GPT，请单击"共享"按钮，然后选择你的共享选项，如图 3.13 所示。

**图 3.13: GPT 共享选项**
- 允许你将链接提供给其他用户
- 仅供你使用
- 将你的 GPT 发布到商店并使其公开
- 如果你提供 GPT 链接或将其公开，该助手的使用来自用户的帐户，而不是你的帐户

无论你是与朋友和同事分享你的 GPT 还是在 GPT Store 中公开分享，助手的使用都来自使用它的帐户，而不是发布者。这意味着如果你有一个特别昂贵的 GPT，例如生成大量图像，它不会影响你的帐户，而其他人使用它。

### 3.5.1 昂贵的 GPT 助手

在撰写本文时，OpenAI 跟踪你的 ChatGPT 帐户的资源使用情况，包括用于 GPT 的资源。如果你达到资源使用限制并被阻止，你的 ChatGPT 帐户也将被阻止。阻止通常只持续几个小时，但这无疑可能非常烦人。

因此，我们希望确保使用你的 GPT 的用户不会超过其正常使用的资源使用限制。以下是在使用 GPT 时增加资源使用的功能列表：

**创建图像** - 图像生成仍然是一项高级服务，连续的图像生成可能会很快导致你的用户被阻止。通常建议你告知用户潜在风险和/或尝试减少生成图像的频率。

**代码解释** - 此功能允许文件上传和运行代码进行数据分析。如果你认为你的用户需要经常使用编码工具，则告知他们风险。

**视觉，描述图像** - 如果你正在构建使用视觉来描述和从图像中提取信息的助手，请计划谨慎使用它。

**文件上传** - 如果你的 GPT 使用大量文件或允许你上传多个文件，这可能会导致阻止。一如既往，引导用户远离任何阻止他们享受你的 GPT 的事物。

**注意：** 摩尔定律指出，计算机的性能每两年翻一番，而成本降低一半。LLM 现在通过优化和增加 GPU 功率，性能大约每六个月翻一番。这与同期成本至少减半相结合，可能意味着当前对视觉和图像生成模型的资源限制将不会被考虑。但是，代码解释和文件上传等服务可能会保持不变。

使你的助手意识到资源使用可以像在助手的指令中添加清单 3.18 中显示的规则一样简单。指令可以只是向用户传达警告并使助手意识到的声明。你甚至可以要求助手限制其对某些功能的使用。

**代码清单 3.18: 资源使用规则示例**

```
RULE:
When generating images, ensure the user is aware that creating multiple
images quickly could temporarily block their account.
```

指导你的助手在最终更加节约资源使你的助手更易于使用。它还有助于防止愤怒的用户在不知不觉中使用你的助手时被阻止。如果你计划发布你的 GPT，这可能很重要，但在此之前，让我们在下一节中调查经济学。

### 3.5.2 理解 GPT 的经济学

在 GPT Assistants 和 GPT Store 发布后，OpenAI 宣布了未来为发布 GPT 的人提供利润分享计划的潜力。虽然我们仍在等待听到更多关于此计划的信息，但许多人推测这可能是什么样子。

一些人建议商店可能只向构建者返回 10% 到 20% 的利润。这远低于其他应用平台上的百分比，但需要的技术知识和资源要少得多。GPT Store 充斥着本质上免费的助手，前提是你有 Plus 订阅，但这可能会在未来改变。无论如何，你可能想要构建公共 GPT 的原因还有几个：

**个人作品集** - 也许你想展示你的提示工程知识或你构建下一波 AI 应用程序的能力。在 GPT Store 中拥有几个 GPT 可以帮助展示你的知识和创建有用的 AI 应用程序的能力。

**知识和经验** - 如果你对某个主题或话题有深入的知识，这可能是将其打包为助手的好方法。这些类型的助手的受欢迎程度将根据你的专业领域而变化。

**交叉营销和商业搭售** - 这在商店中变得越来越普遍，并为公司提供使用助手引导客户的能力。随着公司集成更多 AI，这肯定会变得更加普遍。

**对你的产品/服务有用的助手** - 并非所有公司或组织都能承受托管聊天机器人的成本。虽然使用助手目前仅限于 ChatGPT 订阅者，但将来它们可能会更易于访问。这可能意味着拥有所有内容的 GPT，也许就像互联网的早期，每家公司都急于建立网络存在一样。

虽然 GPT Store 的当前形式是针对 ChatGPT 订阅者的，但如果 OpenAI 的当前趋势继续下去，我们可能会看到完全公开的 GPT Store。公共 GPT 有可能颠覆我们搜索、调查产品和服务以及消费互联网的方式。在本章的最后一节中，我们将研究如何发布 GPT 以及一些重要的考虑因素。

### 3.5.3 发布 GPT

好的，你对你的 GPT 及其运行方式感到满意，并且你看到将其提供给他人的真正好处。发布 GPT 供公众（订阅者）使用很容易，如图 3.14 所示。选择 GPT Store 作为选项并单击"保存"后，你现在将可以选择设置类别并提供指向你的链接。

**图 3.14: 单击保存以发布到 GPT Store 后选择选项**
- 选择此项允许你查看设置链接
- 你可以设置指向你的社交媒体和 GitHub 的链接
- 你想要发布 GPT 的区域

这很容易，所以在发布你的 GPT 之前，你需要考虑以下几件事：

**GPT 描述** - 创建一个好的描述，你甚至可能想要要求 ChatGPT 帮助你构建一个增加 GPT 搜索引擎优化（SEO）的描述。GPT 现在出现在 Google 搜索中,因此良好的搜索引擎优化可以帮助增加对你的助手的曝光。好的描述还将帮助用户决定是否要花时间使用你的助手。

**Logo** - 一个漂亮、干净的 logo，可以识别你的助手做什么，无疑会有所帮助。GPT 的 logo 设计实际上是一项免费服务，但花时间迭代几张图像可以帮助吸引用户使用你的助手。

**类别** - 默认情况下，类别将已经被选中，但要确保它适合你的助手。如果你觉得它不适合，那么更改类别，你甚至可能想要选择"其他"并定义你自己的类别。

**链接** - 确保为你的社交媒体设置参考链接，甚至可能是一个 GitHub 存储库，你可以用它来跟踪 GPT 的问题。向你的 GPT 添加链接向用户展示，如果他们遇到问题或有疑问，他们可以联系构建者。

随着 GPT Store 的成熟，可能会出现进一步的要求。商业模式仍有待建立，其他学习也可能会随之而来。无论你决定为自己还是他人构建 GPT，这样做都可以帮助提高你对如何构建智能体和助手的理解。正如我们将在本书的其余部分看到的那样，GPT 助手是你知识的有用基础。

## 3.6 练习

完成以下练习以提高你对材料的了解：

**练习 1 — 构建你的第一个 GPT 助手**

目标 — 使用 ChatGPT 界面创建一个简单的 GPT 助手。

任务：
- 如果你还没有 ChatGPT Plus 订阅，请注册
- 导航到 GPT Assistants 平台，然后单击"创建"按钮
- 按照 Builder 聊天界面创建一个 Culinary Companion 助手，该助手根据可用食材提供膳食建议
- 手动配置助手以添加食谱生成的自定义规则，例如包括营养信息和成本估算

**练习 2 — 数据分析助手**

目标 — 开发一个可以分析 CSV 文件并提供见解的 GPT 助手。

任务：
- 设计一个可以加载和分析 CSV 文件的数据科学助手，类似于本章中的 Data Scout 示例
- 启用代码解释工具，并上传示例 CSV 文件（例如，来自 Kaggle 的数据集）
- 使用助手执行数据清理、可视化和假设检验等任务
- 记录你的过程和发现，注意任何挑战或需要的改进

**练习 3 — 创建自定义动作**

目标 — 使用 FastAPI 服务通过自定义动作扩展 GPT 助手。

任务：
- 按照步骤创建提供特定功能的 FastAPI 服务，例如获取每日任务列表
- 为服务生成 OpenAPI 规范，并使用 ngrok 在本地部署它
- 配置新助手以使用此自定义动作，确保它正确连接到 FastAPI 端点
- 通过要求助手执行动作来测试助手，并验证输出

**练习 4 — 文件上传知识助手**

目标 — 使用上传的文档构建具有专门知识的助手。

任务：
- 选择与特定主题相关的免费电子书或文档集合（例如，经典文学、技术手册）
- 将这些文件上传到新的 GPT 助手，并将助手配置为上传内容的专家
- 创建一系列提示来测试助手参考和总结文档信息的能力
- 评估助手的性能，并进行任何必要的调整以提高其准确性和有用性

**练习 5 — 发布和分享你的助手**

目标 — 将你的 GPT 助手发布到 GPT Store 并与他人分享。

任务：
- 完成助手的配置和测试，以确保它按预期工作
- 撰写引人注目的描述，并为你的助手创建适当的 logo
- 选择正确的类别，并设置指向你的社交媒体或 GitHub 存储库的任何必要链接
- 将助手发布到 GPT Store，并与朋友或同事分享链接
- 从用户那里收集反馈，并根据他们的输入改进助手，以提高其可用性和功能

## 本章小结

- OpenAI GPT Assistants 平台使通过 ChatGPT UI 构建和部署 AI 智能体成为可能，重点是创建引人入胜且功能齐全的助手。

- 你可以使用 GPT 的代码解释功能对用户上传的 CSV 文件执行数据分析，使助手能够充当数据科学家。

- 助手可以通过自定义动作进行扩展，允许通过 API 端点与外部服务集成。这包括生成 FastAPI 服务及其相应的 OpenAPI 规范。

- 助手可以通过文件上传丰富专门知识，使它们能够充当特定文本或文档的权威来源。

- 将你的 GPT 商业化涉及将其发布到 GPT Store，在那里你可以与更广泛的受众分享和营销你的助手。

- 构建功能助手涉及通过设计提示进行迭代、定义清晰的角色、设置规则，并确保助手的输出与用户期望一致。

- 创建自定义动作需要理解和实施 OpenAPI 规范、使用 ngrok 等工具在本地部署服务，并将这些服务连接到你的助手。

- 知识助手可以处理各种任务，从搜索和比较文档到基于其知识库生成新内容。

- 发布助手需要仔细考虑资源使用、用户体验和经济因素，以确保其对公共使用的有效性和可持续性。

- GPT Store 可供 ChatGPT Plus 订阅者使用，是学习和获得构建 AI 助手熟练程度的宝贵平台，具有未来利润分享机会的潜力。

---

**翻译完成日期:** 2025-11-13
**翻译工具:** Claude AI (Sonnet 4.5)
**用途说明:** 本翻译仅供个人学习使用，请勿用于商业用途
